{% extends "base.html" %}

{% block content %}
  <div style="max-width: 900px; width: 100%;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
      <h2 style="font-size: 24px; color: #111827; margin: 0;">Analysis History</h2>
      <a href="{{ url_for('index') }}" class="btn btn-primary">Upload New File</a>
    </div>

    {% if analyses %}
      <div style="display: flex; flex-direction: column; gap: 16px;">
        {% for analysis in analyses %}
          <div class="card" style="width: 100%; cursor: pointer;" onclick="window.location='{{ url_for('results', analysis_id=analysis.id) }}'">
            <div style="display: flex; justify-content: space-between; align-items: start;">
              <div style="flex: 1;">
                <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px; color: #111827;">
                  {{ analysis.filename }}
                </div>
                <div style="font-size: 12px; color: #6b7280; margin-bottom: 12px;">
                  Uploaded: {{ analysis.uploaded_at.strftime('%Y-%m-%d %H:%M:%S') }}
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
                  <div>
                    <div style="font-size: 11px; color: #6b7280;">Total Sales</div>
                    <div style="font-size: 14px; font-weight: 600; color: #1e40af;">₹{{ "{:,.2f}".format(analysis.total_sales) }}</div>
                  </div>
                  <div>
                    <div style="font-size: 11px; color: #6b7280;">Last 7 Days</div>
                    <div style="font-size: 14px; font-weight: 600; color: #92400e;">₹{{ "{:,.2f}".format(analysis.last_7_days_sales) }}</div>
                  </div>
                  <div>
                    <div style="font-size: 11px; color: #6b7280;">Last 30 Days</div>
                    <div style="font-size: 14px; font-weight: 600; color: #9f1239;">₹{{ "{:,.2f}".format(analysis.last_30_days_sales) }}</div>
                  </div>
                  <div>
                    <div style="font-size: 11px; color: #6b7280;">Records</div>
                    <div style="font-size: 14px; font-weight: 600; color: #166534;">{{ analysis.total_records }}</div>
                  </div>
                </div>
              </div>
              <div style="margin-left: 16px;">
                <span style="font-size: 12px; color: #2563eb;">View Details →</span>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="card" style="text-align: center; padding: 40px;">
        <div style="font-size: 16px; color: #6b7280; margin-bottom: 16px;">
          No analysis history found.
        </div>
        <a href="{{ url_for('index') }}" class="btn btn-primary">Upload Your First File</a>
      </div>
    {% endif %}
  </div>
{% endblock %}
